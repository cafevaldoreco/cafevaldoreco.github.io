<!DOCTYPE html>
<html lang="es">
<head>

  <!-- CSP FINAL FUNCIONAL -->
<meta http-equiv="Content-Security-Policy" 
      content="default-src 'self';
               script-src 'self' 'unsafe-eval' 'unsafe-inline' https://www.gstatic.com https://apis.google.com;
               style-src 'self' 'unsafe-inline' https://fonts.googleapis.com;
               font-src 'self' https://fonts.gstatic.com;
               img-src 'self' data: https:;
               connect-src 'self' 
                 https://www.gstatic.com 
                 https://firestore.googleapis.com 
                 https://identitytoolkit.googleapis.com 
                 https://www.googleapis.com 
                 https://cafelaesperanza-231a4.firebaseapp.com
                 https://securetoken.googleapis.com;
               frame-src 'self' 
                 https://cafelaesperanza-231a4.firebaseapp.com 
                 https://apis.google.com;">

  <!-- Headers que SÍ funcionan en meta tags -->
  <meta http-equiv="X-Content-Type-Options" content="nosniff">
  <meta http-equiv="Referrer-Policy" content="strict-origin-when-cross-origin">
  <meta http-equiv="Permissions-Policy" content="geolocation=(), microphone=(), camera=()">


  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="Accede a tu cuenta de Café Valdore - Inicia sesión o regístrate para gestionar tus pedidos, favoritos y recibir ofertas exclusivas de nuestros cafés.">
  <title>Iniciar Sesión - Café Valdore</title>
  <link rel="stylesheet" href="auth.css">
  
</head>
<body>
  <div class="auth-container">
    <a href="index.html" class="logo">
  <img src="logo.webp" alt="Café Valdore" style="height: 120px;">
</a>
    
    <div id="errorMsg" class="error" style="display: none;"></div>
    <div id="successMsg" class="success" style="display: none;"></div>
    
    <!-- Formulario de Login -->
    <div id="loginForm" class="auth-form active">
      <h2>Iniciar Sesión</h2>
      <input type="email" id="loginEmail" placeholder="Correo electrónico" required>
      <input type="password" id="loginPassword" placeholder="Contraseña" required>
      <button id="loginBtn">Iniciar Sesión</button>
      <button type="button" class="toggle-btn" onclick="toggleForm('register')">¿No tienes cuenta? Regístrate</button>
      <button type="button" class="toggle-btn" onclick="toggleForm('forgot')">¿Olvidaste tu contraseña?</button>
    </div>

    <!-- Formulario de Registro -->
    <div id="registerForm" class="auth-form">
      <h2>Registrarse</h2>
      <input type="text" id="registerName" placeholder="Nombre completo" required>
      <input type="email" id="registerEmail" placeholder="Correo electrónico" required>
      <input type="password" id="registerPassword" placeholder="Contraseña (mín. 6 caracteres)" required>
      <button id="registerBtn">Crear Cuenta</button>
      <button type="button" class="toggle-btn" onclick="toggleForm('login')">¿Ya tienes cuenta? Inicia sesión</button>
    </div>

    <!-- Formulario de Recuperación de Contraseña -->
    <div id="forgotForm" class="auth-form">
      <h2>Recuperar Contraseña</h2>
      <p>Ingresa tu correo electrónico para recibir un enlace de restablecimiento</p>
      <input type="email" id="forgotEmail" placeholder="Correo electrónico" required>
      <button id="sendResetBtn">Enviar Enlace</button>
      <button type="button" class="toggle-btn" onclick="toggleForm('login')">Volver al Inicio de Sesión</button>
    </div>

    <!-- Formulario de Cambio de Contraseña (solo para usuarios autenticados) -->
    <div id="changePassForm" class="auth-form">
      <h2>Cambiar Contraseña</h2>
      <input type="password" id="currentPassword" placeholder="Contraseña actual" required>
      <input type="password" id="newPassword" placeholder="Nueva contraseña" required>
      <input type="password" id="confirmPassword" placeholder="Confirmar nueva contraseña" required>
      <button id="changePassBtn">Cambiar Contraseña</button>
      <button type="button" class="toggle-btn" onclick="toggleForm('login')">Cancelar</button>
    </div>
  
    <a href="index.html" class="back-link">← Volver a la tienda</a>
  </div>

   <!-- Importamos el JS  -->
    <script src="auth.js" type="module"></script>

</body>
</html>