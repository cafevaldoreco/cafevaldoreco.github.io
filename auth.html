<!DOCTYPE html>
<html lang="es">
<head>

  <!-- CSP FINAL FUNCIONAL -->
<meta http-equiv="Content-Security-Policy" 
      content="default-src 'self';
               script-src 'self' 'unsafe-eval' 'unsafe-inline' https://www.gstatic.com https://apis.google.com;
               style-src 'self' 'unsafe-inline' https://fonts.googleapis.com;
               font-src 'self' https://fonts.gstatic.com;
               img-src 'self' data: https:;
               connect-src 'self' 
                 https://www.gstatic.com 
                 https://firestore.googleapis.com 
                 https://identitytoolkit.googleapis.com 
                 https://www.googleapis.com 
                 https://cafelaesperanza-231a4.firebaseapp.com
                 https://securetoken.googleapis.com;
               frame-src 'self' 
                 https://cafelaesperanza-231a4.firebaseapp.com 
                 https://apis.google.com;">

  <!-- Headers que SÍ funcionan en meta tags -->
  <meta http-equiv="X-Content-Type-Options" content="nosniff">
  <meta http-equiv="Referrer-Policy" content="strict-origin-when-cross-origin">
  <meta http-equiv="Permissions-Policy" content="geolocation=(), microphone=(), camera=()">


  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="Accede a tu cuenta de Café Valdore - Inicia sesión o regístrate para gestionar tus pedidos, favoritos y recibir ofertas exclusivas de nuestros cafés.">
  <title>Iniciar Sesión - Café Valdore</title>
  <link rel="stylesheet" href="auth.css">
  
</head>
<body>
  <div class="auth-container">
    <a href="index.html" class="logo">
  <img src="logo.webp" alt="Café Valdore" style="height: 120px;">
</a>
    
    <div id="errorMsg" class="error" style="display: none;"></div>
    <div id="successMsg" class="success" style="display: none;"></div>
    
    <!-- Formulario de Login -->
    <div id="loginForm" class="auth-form active">
      <h2>Iniciar Sesión</h2>
      <input type="email" id="loginEmail" placeholder="Correo electrónico" required>
      <input type="password" id="loginPassword" placeholder="Contraseña" required>
      <!-- En el formulario de Login, después del botón loginBtn -->
<button id="loginBtn">Iniciar Sesión</button>
<div class="separator">
  <span>o</span>
</div>
<button id="googleLoginBtn" class="google-btn">
  <svg width="18" height="18" viewBox="0 0 18 18">
    <path fill="#4285F4" d="M16.51 8H8.98v3h4.3c-.18 1-.74 1.48-1.6 2.04v2.01h2.6a7.8 7.8 0 0 0 2.38-5.88c0-.57-.05-.66-.15-1.18z"/>
    <path fill="#34A853" d="M8.98 17c2.16 0 3.97-.72 5.3-1.94l-2.6-2a4.8 4.8 0 0 1-7.18-2.54H1.83v2.07A8 8 0 0 0 8.98 17z"/>
    <path fill="#FBBC05" d="M4.5 10.52a4.8 4.8 0 0 1 0-3.04V5.41H1.83a8 8 0 0 0 0 7.18l2.67-2.07z"/>
    <path fill="#EA4335" d="M8.98 4.18c1.17 0 2.23.4 3.06 1.2l2.3-2.3A8 8 0 0 0 1.83 5.4L4.5 7.49a4.77 4.77 0 0 1 4.48-3.3z"/>
  </svg>
  Continuar con Google
</button>
      <button type="button" class="toggle-btn" onclick="toggleForm('register')">¿No tienes cuenta? Regístrate</button>
      <button type="button" class="toggle-btn" onclick="toggleForm('forgot')">¿Olvidaste tu contraseña?</button>
    </div>

    <!-- Formulario de Registro -->
    <div id="registerForm" class="auth-form">
      <h2>Registrarse</h2>
      <input type="text" id="registerName" placeholder="Nombre completo" required>
      <input type="email" id="registerEmail" placeholder="Correo electrónico" required>
      <input type="password" id="registerPassword" placeholder="Contraseña (mín. 6 caracteres)" required>
      <!-- Register también con google -->
      <button id="registerBtn">Crear Cuenta</button>
    <div class="separator">
      <span>o</span>
      </div>
      <button id="googleRegisterBtn" class="google-btn">
      <svg width="18" height="18" viewBox="0 0 18 18">
      <path fill="#4285F4" d="M16.51 8H8.98v3h4.3c-.18 1-.74 1.48-1.6 2.04v2.01h2.6a7.8 7.8 0 0 0 2.38-5.88c0-.57-.05-.66-.15-1.18z"/>
      <path fill="#34A853" d="M8.98 17c2.16 0 3.97-.72 5.3-1.94l-2.6-2a4.8 4.8 0 0 1-7.18-2.54H1.83v2.07A8 8 0 0 0 8.98 17z"/>
      <path fill="#FBBC05" d="M4.5 10.52a4.8 4.8 0 0 1 0-3.04V5.41H1.83a8 8 0 0 0 0 7.18l2.67-2.07z"/>
      <path fill="#EA4335" d="M8.98 4.18c1.17 0 2.23.4 3.06 1.2l2.3-2.3A8 8 0 0 0 1.83 5.4L4.5 7.49a4.77 4.77 0 0 1 4.48-3.3z"/>
      </svg>
        Continuar con Google
      </button>
      <button type="button" class="toggle-btn" onclick="toggleForm('login')">¿Ya tienes cuenta? Inicia sesión</button>
    </div>

    <!-- Formulario de Recuperación de Contraseña -->
    <div id="forgotForm" class="auth-form">
      <h2>Recuperar Contraseña</h2>
      <p>Ingresa tu correo electrónico para recibir un enlace de restablecimiento</p>
      <input type="email" id="forgotEmail" placeholder="Correo electrónico" required>
      <button id="sendResetBtn">Enviar Enlace</button>
      <button type="button" class="toggle-btn" onclick="toggleForm('login')">Volver al Inicio de Sesión</button>
    </div>

    <!-- Formulario de Cambio de Contraseña (solo para usuarios autenticados) -->
    <div id="changePassForm" class="auth-form">
      <h2>Cambiar Contraseña</h2>
      <input type="password" id="currentPassword" placeholder="Contraseña actual" required>
      <input type="password" id="newPassword" placeholder="Nueva contraseña" required>
      <input type="password" id="confirmPassword" placeholder="Confirmar nueva contraseña" required>
      <button id="changePassBtn">Cambiar Contraseña</button>
      <button type="button" class="toggle-btn" onclick="toggleForm('login')">Cancelar</button>
    </div>
  
    <a href="index.html" class="back-link">← Volver a la tienda</a>
  </div>

   <!-- Importamos el JS  -->
    <script src="auth.js" type="module"></script>

</body>
</html>